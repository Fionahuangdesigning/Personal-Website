<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fiona Huang</title>
  <link rel="stylesheet" href="./css/base.css" />
</head>

<body>
  <!-- 顶部渐变矩形 -->
  <div class="rainbow-rectangle">
    <div class="scroll-container" id="scrollContainer">
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
      <span class="scroll-text">Always Creating</span>
    </div>
  </div>
  <!-- 网站内容 -->
  <div class="content-wrap">
    <div id="content">
      <div class="title">Fiona Huang</div>
      <div class="font32 text-wrap">
        <div id="text" class="text-container">
          Specialist in design & graphic experiments.
        </div>
        <div>Born in Taiwan. Remade in New York.</div>
        <div>A doctor to cure bad graphics. A scientist to fix boring ideas.</div>
      </div>
      <div class="font20 fontAR">
        <div>
          <div>Flourishing at:</div>
          <div>Pentagram</div>
          <div>School of Visual Arts</div>
          <div>Type@Cooper</div>
          <div>New York University</div>
        </div>
        <div class="mg20">Always training her left hand.</div>
        <div>
          <div>Love animals</div>
          <div>Love traveling</div>
          <div>Love giving</div>
          <div>Love chocolate</div>
          <div>Love R&B</div>
          <div>Love sharing</div>
        </div>
        <div class="mg20">
          <div>Her design is fun,</div>
          <div>so is her life</div>
        </div>
        <div>Explore more by scrolling</div>
      </div>
    </div>
    <div class="show-wrap">
      <div class="project-item project1">
        <img src="./img/project/project1/project1_1.png" alt="" class="project1_1" />
        <div class="flex">
          <img src="./img/project/project1/project1_2_1.png" alt="" />
          <img src="./img/project/project1/project1_2_2.png" alt="" />
          <img src="./img/project/project1/project1_2_3.png" alt="" />
        </div>
        <img src="./img/project/project1/project1_3.png" alt="" />
        <img src="./img/project/project1/project1_4.png" alt="" />
      </div>
      <div class="project-item project2">
        <img src="./img/project/project2/project2_1.png" alt="" class="pt20" />
        <img src="./img/project/project2/project2_2.png" alt="" />
        <img src="./img/project/project2/project2_3.png" alt="" />
        <img src="./img/project/project2/project2_4.jpg" alt="" />
      </div>
      <div class="project-item project3">
        <img src="./img/project/project3/project3_1.png" alt="" class="pt20" />
        <img src="./img/project/project3/project3_2.png" alt="" />
        <img src="./img/project/project3/project3_3.png" alt="" />
        <img src="./img/project/project3/project3_4.png" alt="" />
      </div>
      <div class="project-item project4">
        <img src="./img/project/project4/project4_1.png" alt="" />
        <img src="./img/project/project4/project4_2.png" alt="" class="pt20" />
        <img src="./img/project/project4/project4_3.png" alt="" />
      </div>
      <div class="project-item project5">
        <img src="./img/project/project5/project5_1.png" alt="" class="pt20" />
        <img src="./img/project/project5/project5_2.png" alt="" />
        <img src="./img/project/project5/project5_3.png" alt="" />
      </div>
      <div class="project-item project6">
        <img src="./img/project/project6/project6_1.jpg" alt="" class="pt20" />
        <img src="./img/project/project6/project6_2.png" alt="" class="pt15" />
        <img src="./img/project/project6/project6_3.png" alt="" class="pt20" />
      </div>
      <div class="project-item project7">
        <img src="./img/project/project7/project7_1.png" alt="" class="pt15" />
        <img src="./img/project/project7/project7_2.png" alt="" />
      </div>
    </div>
    <div class="page-foot">
      <div class="title">You know where to find me. </div>
      <div class="mt30">Site designed & coded by me :)</div>
      <div> Typefaces used: owners & chapman by Lite Type </div>
      <a href="mailto:fionahuang1230@gmail.com">fionahuang1230@gmail.com</a>
      <img class="hand-img" src="./img/hand.gif" alt="moving" />
    </div>
    <div class="tooltip" id="tooltip"></div>
  </div>
  <!-- Canvas 用于绘制图片和擦除 -->
  <canvas id="canvas"></canvas>
  <div id="contact" onclick="openContact()">Reach Me!</div>
  <img class="moving-car-img" src="./img/car.gif" alt="car" onclick="sendMail()" />
  <img class="moving-bird-img" src="./img/bird.gif" alt="bird" />
  <script>
    setTimeout(() => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'  // 平滑滚动
      });
    }, 100);
    let eraseCount = 0;
    // 动画状态
    let isJumping = true;
    let jumpTimer, removeTimer, addTimer, carTimer;
    let animationFrame;
    // 鼠标擦除功能
    let isDrawing = false;
    // 屏幕宽高
    const windowWidth = window.innerWidth;
    const windowHeight = window.innerHeight;

    const canvas = document.getElementById("canvas");

    // 文字的宽高（用于避免文字超出屏幕）
    let textWidth, textHeight;

    let tooltipList = [
      { title: "People I Hate", subTitle: "graphic design / poster" },
      { title: "Turkish March", subTitle: "zine / installation" },
      {
        title: "Heartbreaking Books",
        subTitle: "book cover / graphic design",
      },
      { title: "Alpha 10K", subTitle: "book jacket" },
      { title: "PETA", subTitle: "design direction / posters" },
      { title: "Blueprints of Childhood", subTitle: "experiment / posters" },
      { title: "I'll Always Love You", subTitle: "vinyl design" },
    ];

    function JumpText() {
      // 获取文本容器
      const contact = document.getElementById("contact");

      // 初始化文字位置
      function updateTextSize() {
        textWidth = contact.offsetWidth;
        textHeight = contact.offsetHeight;
      }

      // 随机移动文字
      function jump() {
        if (!isJumping) return; // 如果停止跳动，则不执行

        // 初始化
        updateTextSize();

        // 随机生成新的位置
        const maxX = windowWidth - textWidth; // 确保文字不超出屏幕右边界
        const maxY = windowHeight - textHeight; // 确保文字不超出屏幕下边界
        const newX = Math.random() * maxX;
        const newY = Math.random() * maxY;

        // 设置新位置
        contact.style.left = `${newX}px`;
        contact.style.top = `${newY}px`;

        if (jumpTimer) {
          clearTimeout(jumpTimer);
        }
        // 每隔一段时间随机跳动一次
        jumpTimer = setTimeout(() => {
          animationFrame = requestAnimationFrame(jump);
        }, 600);
      }

      // 鼠标进入时停止跳动
      contact.addEventListener("mouseenter", event => {
        isJumping = false;
        cancelAnimationFrame(animationFrame); // 停止动画
      });

      // 鼠标离开时继续跳动
      contact.addEventListener("mouseleave", () => {
        isJumping = true;
        jump(); // 重新开始跳动
      });

      // 调整窗口大小时更新文字位置
      window.addEventListener("resize", () => {
        updateTextSize();
      });

      jump(); // 开始跳动
    }

    function sendMail() {
      const email = "fionahuang1230@gmail.com";
      window.location.href = `mailto:${email}`;
    }

    function explodingText() {
      // 获取文本容器
      const textContainer = document.getElementById("text");
      const text = textContainer.textContent.trim();

      // 清空容器并将每个字拆分为单独的span元素
      textContainer.innerHTML = "";
      text.split(" ").forEach((char, index) => {
        const span = document.createElement("span");
        span.className = "char";
        span.textContent = char;
        textContainer.appendChild(span);
      });

      // 获取所有字符元素
      const chars = document.querySelectorAll(".char");

      // 随机设置偏移和旋转的函数
      function setRandomProperties(char, value) {
        char.style.setProperty("--offset-x", (Math.random() * 2 - 1) * 1.5); // 随机左右偏移 -1.5 到 1.5
        char.style.setProperty("--random-y", getRandomY()); // 随机向上移动距离 0.2 到 1
      }

      // 鼠标悬停事件
      textContainer.addEventListener("mouseenter", event => {
        event.stopPropagation(); // 防止事件冒泡到父元素
        if (addTimer) {
          clearTimeout(addTimer);
        }

        addTimer = setTimeout(() => {
          console.log("mouseleave,鼠标进入了");
          chars.forEach(char => {
            // 每次悬停时重新随机设置位置
            setRandomProperties(char);
            char.classList.add("explode");
          });
        }, 200);
      });

      // 鼠标离开后重置效果
      textContainer.addEventListener("mouseleave", event => {
        event.stopPropagation(); // 防止事件冒泡到父元素

        if (removeTimer) {
          clearTimeout(removeTimer);
        }
        removeTimer = setTimeout(() => {
          console.log("mouseleave,鼠标离开了");
          chars.forEach(char => {
            char.classList.remove("explode");
          });
        }, 200);
      });
    }

    function drawImage() {
      const ctx = canvas.getContext("2d");

      // 设置 Canvas 尺寸为窗口大小
      canvas.width = windowWidth;
      canvas.height = windowHeight;
      // 加载图片
      const img = new Image();
      img.src = "./img/bbb05a90-2c3b-4148-abf8-dcb13d20cb91.png"; // 替换为你的图片地址
      img.onload = () => {
        // 将图片绘制到 Canvas 上
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      };

      // 鼠标离开 Canvas 时停止擦除
      canvas.addEventListener("mouseleave", () => {
        isDrawing = false;
      });

      // 监听鼠标移动事件
      canvas.addEventListener("mousemove", moveEvent);

      function moveEvent(event) {
        isDrawing = true;
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;
        // 设置擦除效果
        ctx.globalCompositeOperation = "destination-out"; // 擦除模式
        ctx.beginPath();
        ctx.arc(x, y, 80, 0, Math.PI * 2, false); // 圆形橡皮擦，大小为 20
        ctx.fill();
        ctx.globalCompositeOperation = "source-over"; // 恢复默认模式

        // 可选：检测擦除完成
        const totalPixels = canvas.width * canvas.height;
        if (isDrawing) {
          eraseCount += 1000; // 粗略估计擦除的像素量
          if (eraseCount > totalPixels * 0.1) {
            // 擦除超过 50% 时隐藏
            // canvas.classList.add("hidden");
            // document.body.style.overflow = "auto"; // 恢复滚动

            document.getElementById("contact").style.zIndex = 5;
            document.getElementById("text").style.zIndex = 5;
            // // 初始触发
            // if (carTimer) {
            //   clearInterval(carTimer);
            //   birdGif();
            // }
            // // 每隔 10 秒触发一次
            // carTimer = setInterval(birdGif, 10000);
          }
        }
      }

      // 调整窗口大小时重置 Canvas
      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      });
    }

    function scrollText() {
      const container = document.getElementById("scrollContainer");
      let position = 0;
      let speed = 3; // 滚动速度（像素/帧）
      let animationFrameId;

      function scroll() {
        position -= speed;
        container.style.transform = `translateX(${position}px)`;

        // 当第一个文字完全移出容器时，重置位置
        const firstText = container.querySelector(".scroll-text");
        const textWidth =
          firstText.offsetWidth +
          parseInt(getComputedStyle(firstText).marginRight);

        if (Math.abs(position) >= textWidth) {
          position += textWidth; // 重置位置
          container.appendChild(firstText); // 将第一个文字移到末尾
        }

        animationFrameId = requestAnimationFrame(scroll);
      }

      // 开始动画
      scroll();

      // 鼠标悬停暂停，移开继续
      container.addEventListener("mouseenter", () => {
        cancelAnimationFrame(animationFrameId);
      });

      container.addEventListener("mouseleave", () => {
        scroll();
      });
    }

    function tooltip() {
      let projectList = document.querySelectorAll(".project-item");
      let tooltip = document.getElementById("tooltip");
      projectList.forEach((project, index) => {
        // 鼠标进入项目时显示提示框
        project.addEventListener("mouseenter", event => {
          tooltip.style.left = event.clientX + 10 + "px";
          tooltip.style.top = event.clientY + 20 + "px";
          tooltip.style.opacity = "1";
          tooltip.style.transform = "scale(1)";
          tooltip.style.zIndex = "10";
          tooltip.innerHTML = `
                    <div class="tooltip-title black">${tooltipList[index].title}</div>
                    <div class="tooltip-sub-title gray">${tooltipList[index].subTitle}</div>
                `;
        });
        // 鼠标移动时更新提示框位置
        project.addEventListener("mousemove", event => {
          tooltip.style.left = event.clientX + 10 + "px";
          tooltip.style.top = event.clientY + 20 + "px";
        });
        // 鼠标离开项目时隐藏提示框
        project.addEventListener("mouseleave", () => {
          tooltip.style.opacity = "0";
          tooltip.style.transform = "scale(0.8)";
          // tooltip.style.transition = "all 0.3s ease";
        });
      });
    }

    function birdGif() {
      const birdGif = document.querySelector(".moving-bird-img");
      // 随机高度 (避免超出视口)
      const maxHeight = (window.innerHeight - 300) * 0.3;
      let randomTop = Math.floor(Math.random() * maxHeight);

      // console.log(randomTop, window.innerHeight);

      // 重置样式
      // if (randomTop < (window.innerHeight - 200)) {
      //   randomTop = window.innerHeight - 200;
      // }
      birdGif.style.top = `${randomTop}px`;
      birdGif.style.display = "block";
      birdGif.style.animation = "none";
      birdGif.onclick = () => {
        window.open("https://www.instagram.com/fifionana_aa/", "_blank");
      };

      // 触发重绘以重新启动动画
      void birdGif.offsetWidth;
      birdGif.style.animation = "moveLeft 5s linear forwards";
      document.body.appendChild(birdGif);
    }

    // 判断是否为移动设备
    function isMobileOrTablet() {
      const ua = navigator.userAgent.toLowerCase();

      const isIpad =
        /ipad/.test(ua) ||
        (navigator.platform === "MacIntel" && navigator.maxTouchPoints > 1);
      const isIphoneOrAndroid = /iphone|ipod|android.*mobile/.test(ua);

      return isIpad || isIphoneOrAndroid;
    }

    if (isMobileOrTablet()) {
      alert("请使用PC浏览器访问！");
      document.documentElement.style.display = "none";
    }

    // 文字爆炸效果
    explodingText();
    // 鼠标擦除效果
    drawImage();

    // 文字滚动效果
    scrollText();

    tooltip();

    // 生成避开 0.4-0.6 区间的随机值的函数
    function getRandomY() {
      let value;
      // 50% 概率选择区间
      if (Math.random() < 0.5) {
        // 0 到 0.25 区间
        value = Math.random() * 0.25; // 生成 0 到 0.25
      } else {
        // 0.7 到 1 区间
        value = Math.random() * 0.3 + 0.7; // 生成 0.7 到 1
      }
      return value;
    }

    function openContact() {
      window.open(
        "https://www.linkedin.com/in/fionahuang123456?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app",
        "_blank"
      );
    }

    // 鼠标轨迹实现
    function mouseTrailEffect(event) {
      // 获取body元素
      const body = document.body;

      // 存储轨迹点的数组
      let trails = [];
      // 创建新的轨迹点
      let imgEl = document.createElement("img");
      imgEl.src = "./img/cursor.png"; // 替换为你的图片地址

      imgEl.className = "trail";
      imgEl.style.left = event.pageX + "px";
      imgEl.style.top = event.pageY + "px";

      // 添加到页面
      body.appendChild(imgEl);
      trails.push(imgEl);

      // 限制轨迹点数量（例如最多20个）
      if (trails.length > 20) {
        let oldDot = trails.shift();
        oldDot.remove();
      }

      // 逐渐淡出效果
      setTimeout(() => {
        imgEl.style.opacity = "0";
        imgEl.style.transform = "scale(0.5)";
      }, 150);

      // 完全移除
      setTimeout(() => {
        imgEl.remove();
        let index = trails.indexOf(imgEl);
        if (index > -1) {
          trails.splice(index, 1);
        }
      }, 600);
    }

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          console.log("元素出现一半啦 ✅");
          canvas.classList.add("hidden");
          document.getElementById("contact").style.zIndex = 5;
          document.getElementById("text").style.zIndex = 5;
          document.querySelector(".moving-car-img").style.display = "block";
          
            // 跳动文字效果
            JumpText();
          
          
          // 初始触发
          birdGif();
          if (carTimer) {
            clearInterval(carTimer);
          }
          // 每隔 10 秒触发一次
          carTimer = setInterval(birdGif, 5 * 1000);
        }
      },
      {
        threshold: 0.5, // 元素显示 50% 时触发
      }
    );

    const target = document.querySelector(".project1_1"); // 目标元素
    observer.observe(target);
    window.addEventListener("mousemove", mouseTrailEffect);
    window.addEventListener("scroll", () => {
      console.log(window.scrollY);
      if (window.scrollY < 500) {
        document.querySelector(".moving-car-img").style.display = "none";
        document.querySelector(".moving-bird-img").style.display = "none";
        clearInterval(carTimer);
      }
    });
  </script>
</body>

</html>
